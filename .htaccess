<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Don't rewrite files or directories
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Rewrite all other requests to index.html for client-side routing
  RewriteRule ^(.*)$ index.html [L]
</IfModule>

# Don't cache main JavaScript bundles (they have hashes for versioning)
<FilesMatch "^/assets/index-.*\.js$">
  Header set Cache-Control "max-age=0, public, must-revalidate"
  Header set Pragma "no-cache"
  Header set Expires "0"
</FilesMatch>

# Cache vendor and library chunks (they're stable)
<FilesMatch "^/assets/(vendor|framer|supabase|radix|CherryBlossomTree)-.*\.js$">
  Header set Cache-Control "max-age=31536000, public, immutable"
</FilesMatch>

# Don't cache CSS either
<FilesMatch "^/assets/index-.*\.css$">
  Header set Cache-Control "max-age=0, public, must-revalidate"
  Header set Pragma "no-cache"
  Header set Expires "0"
</FilesMatch>

# Cache static assets (images, fonts, etc)
<FilesMatch "\.(jpg|jpeg|png|gif|ico|svg|webp|ttf|woff|woff2)$">
  Header set Cache-Control "max-age=31536000, public, immutable"
</FilesMatch>

# Never cache HTML
<FilesMatch "\.html$">
  Header set Cache-Control "max-age=0, public, must-revalidate"
  Header set Pragma "no-cache"
  Header set Expires "0"
</FilesMatch>

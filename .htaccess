<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Exclude robots.txt and sitemap.xml from ALL rewrites
  RewriteCond %{REQUEST_URI} !^/robots\.txt$
  RewriteCond %{REQUEST_URI} !^/sitemap\.xml$
  RewriteCond %{REQUEST_URI} !^/\.well-known/
  # Allow all existing files and directories
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Only rewrite if none of the above conditions matched
  RewriteRule ^(.*)$ index.html [L]
</IfModule>

# MIME Types
<IfModule mod_mime.c>
  AddType application/javascript .js
  AddType text/css .css
  AddType text/plain .txt
  AddType application/xml .xml
  AddEncoding gzip .gz
</IfModule>

# Cache control
<FilesMatch "\.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2)$">
  <IfModule mod_headers.c>
    Header set Cache-Control "public, max-age=31536000, immutable"
  </IfModule>
</FilesMatch>

<FilesMatch "\.(html|json|xml|txt)$">
  <IfModule mod_headers.c>
    Header set Cache-Control "public, max-age=0, must-revalidate"
  </IfModule>
</FilesMatch>
